<!DOCTYPE html>
<html>
    <head>
          <meta charset='utf-8'>
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


        <title> {% block title %}Infrastructure informatique de l'hôpital de Cahors {% endblock %} </title>
         
         
         {% block stylesheets %} 

        <style>
        
        #calendrier
        {   
            width: 80%;
            margin: auto;
        }
        #body
         {    
            font-family: serif;
        }
        
        </style>
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.3.0/main.min.css" integrity="sha256-uq9PNlMzB+1h01Ij9cx7zeE2OR2pLAfRw3uUUOOPKdA=" crossorigin="anonymous">
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.2.1/dist/Zephyr/bootstrap.css">
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.2.1/dist/Zephyr/bootstrap.min.css">
           

       

        {% endblock %}
        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.3.0/locales-all.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.3.0/main.min.js" integrity="sha256-DBxkGZLxKsLKhz054qUpBqtotG00r9AELGpSigJujLg=" crossorigin="anonymous"></script>
        
        
        
       
        
        
        
    </head>


       


{% block body %}

{% if app.user %}
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <a class="navbar-brand" href={{path('home')}}>Gestion informatique</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      
       <li class="nav-item">
        <a class="nav-link" href={{path('show')}}>Dashboard </a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Utilisateurs <i class="fa-solid fa-user"></i>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href={{path('inscription')}}>Enregistrer un nouveau utilisateur</a>
          <a class="dropdown-item" href={{path('users')}}>Liste des utilisateurs</a>
        </div>
      </li>
        <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
       Informatique <i class="fa-solid fa-server"></i>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href={{path('create')}}>Enregistrer un nouveau serveur</a>
          <a class="dropdown-item" href={{path('createRouteur')}}>Enregistrer un nouvel équipement réseau</a>
          <a class="dropdown-item" href={{path('create')}}>Enregistrer une  nouvelle application</a>
           <a class="dropdown-item" href={{path('newdocument')}}>Ajouter un document</a>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Contacts <i class="fa-solid fa-address-book"></i>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href={{path('contactinscription')}}>Enregistrer un nouveau contact</a>
          <a class="dropdown-item" href={{path('contacts')}}>Voir les contacts </a>
        </div>
      </li>
       <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Agenda <i class="fa-solid fa-calendar-days"></i>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href={{path('app_agenda_index')}}>Voir l'agenda </a>
          <a class="dropdown-item" href={{path('app_agenda_new')}}>Ajouter un nouveau rendez vous </a>
        </div>
      </li>
    </ul>
  </div>
</nav>
{% endif %}
<br> 
  <div class='container mt-4'> <a href="{{ path('app_agenda_new') }}"><i class="fa-solid fa-calendar-plus"></i> Nouveau rdv</a><div class='container-mt4'>

    <div id="calendrier">
   
    </div>
{% endblock %}

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.js"></script>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script src="https://kit.fontawesome.com/70f98bf25c.js" crossorigin="anonymous"></script>
<script>
    window.onload = () => {
        let calendarElt = document.querySelector("#calendrier")
        let calendar = new FullCalendar.Calendar(calendarElt, {
            allDaySlot: false,
            
            editable: true,
            eventResizableFromStart: true,
            initialView: 'timeGridWeek',
            locale: 'fr',
            timeZone: 'Europe/Paris',
            headerToolbar: {
                start: 'prev',
                center: 'title',
                end : 'next'
                
            },
            events: {{ data|raw }},
            editable: true,
            eventResizableFromStart: true,  
            eventClick: (e) => {
                    // Ouvre un formulaire de modification pour l'événement sélectionné
                    // Utilisez e.event pour accéder aux propriétés de l'événement
                    let url = `/edit/agenda/${e.event.id}/edit`;
                    // Rediriger vers la page de modification
                    window.location.href = url;
                }
        })
        calendar.on('eventChange', (e) => {
            let url = `/api/${e.event.id}/edit`
            let donnees = {
                "title": e.event.title,
                "description": e.event.extendedProps.description,
                "start": e.event.start,
                "end": e.event.end,
                "backgroundColor": e.event.backgroundColor,
                "borderColor": e.event.borderColor,
                "textColor": e.event.textColor,
                "allDay": e.event.allDay
                
            }
            
            let xhr = new XMLHttpRequest
            xhr.open("PUT", url)
            xhr.send(JSON.stringify(donnees))
        })
        
        calendar.on('eventChange',(e) => {})

        calendar.render()
    }
</script>

{% endblock %}





 